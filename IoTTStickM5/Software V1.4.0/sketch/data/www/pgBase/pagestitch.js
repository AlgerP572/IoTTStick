function upgradeJSONVersionGH(a){jsonFileVersion="1.0.0";var b=a.Version;return console.log(b),b==jsonFileVersion?a:((isNaN(b)||(b=void 0))&&(console.log("upgrade GreenHat from noversion to 1.0.0"),a.Version="1.0.0"),a)}function upgradeJSONVersionSwitch(a){jsonFileVersion="1.0.0";var b=a.Version;return b==jsonFileVersion?a:((isNaN(b)||(b=void 0))&&(console.log("upgrade Switches from noversion to 1.0.0"),a.Version="1.0.0"),a)}function upgradeJSONVersionLED(a){jsonFileVersion="1.1.2";var b=a.Version;if(b==jsonFileVersion)return a;if((isNaN(b)||void 0==b)&&(console.log("upgrading LEDs to 1.1.0"),a.Version="1.1.0"),"1.1.0"==a.Version&&(console.log("upgrading LEDs to 1.1.1"),a.MQTT={Subscribe:[{Topic:"LEDSET",InclAddr:!1},{Topic:"LEDASK",InclAddr:!1}],Publish:[{Topic:"LEDREPLY",InclAddr:!1}]},a.Version="1.1.1"),"1.1.1"==a.Version){console.log("upgrading LEDs to 1.1.2");for(var c=0;c<a.LEDDefs.length;c++){var d=Array.isArray(a.LEDDefs[c].LEDCmd.CtrlAddr);d||(a.LEDDefs[c].LEDCmd.CtrlAddr=[a.LEDDefs[c].LEDCmd.CtrlAddr]),"switch"==a.LEDDefs[c].CtrlSource&&(a.LEDDefs[c].LEDCmd.pop(),a.LEDDefs[c].LEDCmd.slice(1,1),a.LEDDefs[c].LEDCmd[0].Val=0,a.LEDDefs[c].LEDCmd[1].Val=1),"signalstat"==a.LEDDefs[c].CtrlSource&&(a.LEDDefs[c].CtrlSource="switch")}a.Version="1.1.2"}return a}function upgradeJSONVersionBtn(a){jsonFileVersion="1.1.3";var b=a.Version;if(b==jsonFileVersion)return a;if(isNaN(b)||(b=void 0)){console.log("upgrade buttons from noversion to 1.1.1");for(var c=0;c<a.Buttons.length;c++)void 0==a.Buttons[c].EventMask&&(a.Buttons[c].EventMask=31);a.Version="1.1.1"}return"1.1.1"==a.Version&&(console.log("upgrade buttons to 1.1.2"),a.MQTT={Subscribe:[{Topic:"BTNASK",InclAddr:!1}],Publish:[{Topic:"BTNREPORT",InclAddr:!1},{Topic:"BTNREPLY",InclAddr:!1}]},a.Version="1.1.2"),"1.1.2"==a.Version&&(console.log("upgrade buttons to 1.1.3"),a.RefreshInterval=3e4,a.Sensitivity=2,a.Version="1.1.3"),a}function upgradeJSONVersionBtnHdlr(a){jsonFileVersion="1.3.1";var b=a.Version;if(b==jsonFileVersion)return a;if(void 0==b){console.log("upgrade button handler from noversion to 1.3.0");for(var c=0;c<a.ButtonHandler.length;c++){for(var d=0;d<a.ButtonHandler[c].CtrlCmd.length;d++)"onanalog"==a.ButtonHandler[c].CtrlCmd[d].EventType&&a.ButtonHandler[c].CtrlCmd.splice(d,1);for(var d=0;d<a.ButtonHandler[c].CtrlCmd.length;d++)("onbtndown"==a.ButtonHandler[c].CtrlCmd[d].EventType||"onbtnhold"==a.ButtonHandler[c].CtrlCmd[d].EventType)&&void 0==a.ButtonHandler[c].CtrlCmd[d].BtnCondAddr&&(a.ButtonHandler[c].CtrlCmd[d].BtnCondAddr=65535)}a.Version="1.3.0",b="1.3.0"}if("1.3.0"==b){console.log("upgrade button handler from 1.3.0 to 1.3.1");for(var c=0;c<a.ButtonHandler.length;c++){a.ButtonHandler[c].EventSource="button",a.ButtonHandler[c].CurrDisp=0,a.ButtonHandler[c].CondData=[0];var e=a.ButtonHandler[c].ButtonNr;a.ButtonHandler[c].ButtonNr=[],isNaN(e)||a.ButtonHandler[c].ButtonNr.push(e);for(var d=0;d<a.ButtonHandler[c].CtrlCmd.length;d++){delete a.ButtonHandler[c].CtrlCmd[d].EventType;var e=a.ButtonHandler[c].CtrlCmd[d].BtnCondAddr;a.ButtonHandler[c].CtrlCmd[d].BtnCondAddr=[],isNaN(e)||65535!=e&&a.ButtonHandler[c].CtrlCmd[d].BtnCondAddr.push(e)}}a.Version="1.3.1",b="1.3.1"}return a}function addFileSeqLED(a,b){console.log(a),console.log(b);for(var c=0;c<a.LEDDefs.length;c++)b[1].LEDDefs.push(JSON.parse(JSON.stringify(a.LEDDefs[c]))),b[2]=JSON.parse(JSON.stringify(b[1]))}function addFileSeqBtnHdlr(a,b){console.log(a),console.log(b);for(var c=0;c<a.ButtonHandler.length;c++)b[1].ButtonHandler.push(JSON.parse(JSON.stringify(a.ButtonHandler[c]))),b[2]=JSON.parse(JSON.stringify(b[1]))}function prepareFileSeqLED(a,b){function c(){var a={LEDDefs:[]};return transferData[b].FileList.push(a),a}var d=c();d.Version=jsonFileVersion,d.ChainParams=JSON.parse(JSON.stringify(a.ChainParams)),d.MQTT=JSON.parse(JSON.stringify(a.MQTT)),d.LEDCols=JSON.parse(JSON.stringify(a.LEDCols));for(var e=0,f=0;f<a.LEDDefs.length;f++){var g=JSON.stringify(a.LEDDefs[f]);e+=g.length,d.LEDDefs.push(JSON.parse(g)),e>targetSize&&f<a.LEDDefs.length-1&&(d=c(),e=0)}console.log(transferData)}function prepareFileSeqBtnEvt(a,b){function c(){var a={ButtonHandler:[]};return transferData[b].FileList.push(a),a}var d=c();d.Version=jsonFileVersion;for(var e=0,f=0;f<a.ButtonHandler.length;f++){var g=JSON.stringify(a.ButtonHandler[f]);e+=g.length,d.ButtonHandler.push(JSON.parse(g)),e>targetSize&&f<a.ButtonHandler.length-1&&(d=c(),e=0)}}
